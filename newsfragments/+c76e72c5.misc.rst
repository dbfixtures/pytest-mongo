Separated factories into its own source files.
